#!/usr/bin/env ruby

require "yaml"
require "mechanize"

config = YAML.load_file(File.expand_path("~/.airbears"))
username = config["username"]
password = config["password"]

uri = "https://auth.berkeley.edu/cas/login?service=https%3a%2f%2fwlan.berkeley.edu%2fcgi-bin%2flogin%2fcalnet.cgi"
request = Mechanize.new
request.get(uri) do |page|
  page.form_with(:method => "POST") do |f|
    f["username"] = username
    f["password"] = password
    f.submit
  end
end

puts "Logged in."
