#!/usr/bin/env zsh

HOST="admin@example.com"
SOURCE="/home/admin/"
TARGET="$HOME/Downloads"

# Create the target directory.
mkdir -p $TARGET

# Sync and remove all hardlinks.
rsync -rzP --exclude=".keep" --remove-source-files $HOST:$SOURCE $TARGET

# Remove empty directories.
ssh $HOST "find $SOURCE -type d -empty -prune -exec rmdir --ignore-fail-on-non-empty -p \{\} \;"
